<%= content_tag :div, "", id: "device", :style => "position: relative; height:390px;",
data: {chartdata: Measurement.chart_data_for_device(@data)} %>
<%#= "Important comment!: " %>
<%#= "javascript for Morris must be included under div or after document ready.
<%#= "Also ids(e.g element) must not contain dashes!!!.Otherwise, morris chart won't show" %>
<%#= "The reason this Morris chart is embedded in view is because we want to change on the fly" %>
<%#= "ykeys and labels coming from the controller" %>
<%= javascript_tag do %>
	devicegraph = Morris.Line({
	element: 'device',
	data: $('#device').data('chartdata'),
	xkey:'created_at',
	ykeys: <%= raw @measure_names %>,
	labels:<%= raw @measure_names %>,
	pointSize: 5,
	hideHover: 'auto',
	resize: true,
	lineWidth:2,
	xLabelAngle: 60,
	axis: true,
	grid: true
	});
$(".dropdown-menu li a").click(function() {
if (this.id === "sevendays") {
return $.ajax({
url: window.location.href + '/sevendays',
data: {
format: 'json'
},
datatype: 'json',
cache: false,
type: 'GET',
success: function(response) {
return devicegraph.setData(response);
}
});
} else if (this.id === 'thirtydays') {
return $.ajax({
url: window.location.href + '/thirtydays',
data: {
format: 'json'
},
datatype: 'json',
cache: false,
type: 'GET',
success: function(response) {
return devicegraph.setData(response);
}
});
} else if (this.id === 'sixmonths') {
return $.ajax({
url: window.location.href + '/sixmonths',
data: {
format: 'json'
},
datatype: 'json',
cache: false,
type: 'GET',
success: function(response) {
return devicegraph.setData(response);
}
});
} else if (this.id === 'c_year') {
return $.ajax({
url: window.location.href + '/c_year',
data: {
format: 'json'
},
datatype: 'json',
cache: false,
type: 'GET',
success: function(response) {
return devicegraph.setData(response);
}
});
} else if (this.id === 'l_year') {
return $.ajax({
url: window.location.href + '/l_year',
data: {
format: 'json'
},
datatype: 'json',
cache: false,
type: 'GET',
success: function(response) {
return devicegraph.setData(response);
}
});
};
});
<% end %>